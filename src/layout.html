<!doctype html>
"jer":"Jeremiah","lam":"Lamentations","ezek":"Ezekiel","dan":"Daniel","hos":"Hosea","joel":"Joel","amos":"Amos",
"obad":"Obadiah","jon":"Jonah","mic":"Micah","nah":"Nahum","hab":"Habakkuk","zeph":"Zephaniah","hag":"Haggai",
"zech":"Zechariah","mal":"Malachi","mt":"Matthew","matt":"Matthew","mk":"Mark","mrk":"Mark","lk":"Luke","lu":"Luke",
"jn":"John","rom":"Romans","1cor":"1 Corinthians","2cor":"2 Corinthians","gal":"Galatians","eph":"Ephesians",
"phil":"Philippians","col":"Colossians","1thess":"1 Thessalonians","2thess":"2 Thessalonians",
"1tim":"1 Timothy","2tim":"2 Timothy","tit":"Titus","phlm":"Philemon","heb":"Hebrews","jas":"James",
"1pet":"1 Peter","2pet":"2 Peter","1jn":"1 John","2jn":"2 John","3jn":"3 John","jude":"Jude","rev":"Revelation"
};


function titleCaseBook(s){
const parts = s.split(/\s+/);
return parts.map((p,i)=> (i===0 && /^\d+$/.test(p)) ? p : (p.charAt(0).toUpperCase()+p.slice(1).toLowerCase())).join(" ");
}
function parseRef(q){
q = (q||"").trim().replace(/\s+/g," ");
const m = q.match(/^(.+?)\s+(\d+)(?::|\.)(\d+)$/);
if(!m) return null;
const raw = m[1].trim();
const chap = Number(m[2]);
const vs = Number(m[3]);
const key = raw.toLowerCase().replace(/\s+/g,'');
const book = ABBR[key] || titleCaseBook(raw);
if(!BOOK_SLUGS[book]) return null;
return {book, chapter: chap, verse: vs};
}
(function(){
const form = document.getElementById('yltSearch');
const input = document.getElementById('yltQuery');
if(!form || !input) return;
form.addEventListener('submit', (e)=>{
e.preventDefault();
const p = parseRef(input.value);
if(!p){ input.value=''; input.placeholder='Try e.g., John 3:16'; return; }
const slug = BOOK_SLUGS[p.book];
location.href = `${ORIGIN}/${slug}/${p.chapter}/${p.verse}/`;
});
})();


// Share handlers
function currentRef(){ return `${BOOK} ${CHAPTER}:${VERSE}`; }
function payload(){
const ref = currentRef();
const url = location.href;
const verseEl = document.querySelector('.verse');
const textOnly = verseEl ? verseEl.textContent.replace(/^\s*\d+\s*/, '').trim() : '';
const tweet = textOnly ? `${ref} — ${textOnly}` : ref;
return {ref,url,tweet,textOnly};
}
function openWin(u){ window.open(u,'_blank','noopener'); }
document.getElementById('fbBtn')?.addEventListener('click', ()=>{ const {url}=payload(); openWin('https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(url)); });
document.getElementById('xBtn')?.addEventListener('click', ()=>{ const {url,tweet}=payload(); openWin('https://twitter.com/intent/tweet?text='+encodeURIComponent(tweet)+'&url='+encodeURIComponent(url)); });
document.getElementById('liBtn')?.addEventListener('click', ()=>{ const {url}=payload(); openWin('https://www.linkedin.com/sharing/share-offsite/?url='+encodeURIComponent(url)); });
document.getElementById('emailBtn')?.addEventListener('click', ()=>{ const {ref,url,textOnly}=payload(); const subj=encodeURIComponent(ref); const body=encodeURIComponent((textOnly? textOnly+'\n\n':'' )+url); location.href=`mailto:?subject=${subj}&body=${body}`; });
document.getElementById('copyBtn')?.addEventListener('click', async ()=>{ const {ref,url,textOnly}=payload(); try{ await navigator.clipboard.writeText(`${ref}${textOnly?' — '+textOnly:''}\n${url}`); const b=document.getElementById('copyBtn'); b.classList.add('copy-ok'); setTimeout(()=>b.classList.remove('copy-ok'),1200);}catch(e){} });
document.getElementById('igBtn')?.addEventListener('click', ()=>{ openWin('https://www.instagram.com/living.word.bibles/'); });
</script>
</body>
</html>
